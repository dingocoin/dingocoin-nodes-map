# ===========================================
# ATLASP2P - CLOUD SUPABASE MODE CONFIGURATION
# ===========================================
# This file is a TEMPLATE.
#
# Setup Instructions:
#   1. Create Supabase project at https://supabase.com
#   2. Run: make setup-cloud
#   3. This copies to .env (gitignored)
#   4. Edit .env with your Supabase Cloud credentials
#   5. Run: make cloud-dev
#
# Mode: Managed Supabase (Web + Crawler only, DB in cloud)
# Use when: Prefer managed database over local Docker
#
# Services included:
#   - Next.js (web app on port 4000)
#   - Python (crawler)
#   - Supabase Cloud (database, auth, storage, realtime)
#
# Before running:
#   1. Create Supabase project
#   2. Get credentials from Settings → API
#   3. Run migrations: supabase link && supabase db push
#   4. Create storage bucket (see docs)
# ===========================================

# -------------------------------------------
# DOCKER COMPOSE
# -------------------------------------------
# Docker Compose Project Name
# Controls container and image naming (e.g., atlasp2p-web, atlasp2p-crawler)
COMPOSE_PROJECT_NAME=atlasp2p

# -------------------------------------------
# SUPABASE CLOUD (REQUIRED)
# -------------------------------------------
# Get from: Dashboard → Settings → API

# Project URL (e.g., https://xxxxx.supabase.co)
NEXT_PUBLIC_SUPABASE_URL=https://your-project-ref.supabase.co

# Anon/Public Key (safe to expose to client)
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here

# Service Role Key (KEEP SECRET - server-side only)
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here

# Supabase API URL (used by crawler for database access)
# Cloud mode: Use external HTTPS URL (same as public URL)
SUPABASE_URL=https://your-project-ref.supabase.co

# Supabase Internal URL (server-side container-to-container communication)
# Cloud mode: Use external HTTPS URL (same as public URL for cloud)
SUPABASE_INTERNAL_URL=https://your-project-ref.supabase.co

# -------------------------------------------
# DEVELOPMENT SETTINGS
# -------------------------------------------
NODE_ENV=development

# ===========================================
# PORT CONFIGURATION
# ===========================================
# Web app port - change to avoid conflicts or run multiple instances
PORT=4000
WEB_PORT=4000                  # Web app external (same as PORT)

# -------------------------------------------
# GEOIP CONFIGURATION
# -------------------------------------------
GEOIP_DB_PATH=/app/data/geoip

# MaxMind credentials (optional - get free account)
# https://dev.maxmind.com/geoip/geolite2-free-geolocation-data
MAXMIND_ACCOUNT_ID=
MAXMIND_LICENSE_KEY=

# -------------------------------------------
# EMAIL SERVICE SECRETS (PRODUCTION)
# -------------------------------------------
# Choose ONE provider (configured in project.config.yaml)

# Resend (recommended - https://resend.com)
RESEND_API_KEY=

# SendGrid (alternative - https://sendgrid.com)
SENDGRID_API_KEY=

# Custom SMTP (if using 'smtp' provider in config)
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_TLS=true

# -------------------------------------------
# SECURITY - TURNSTILE (CLOUDFLARE)
# -------------------------------------------
# Cloudflare Turnstile for bot protection
# Get keys at: https://dash.cloudflare.com/turnstile
#
# NOTE: Turnstile config (enabled, siteKey, protectedActions) is in config/project.config.yaml
# ONLY the secret key goes in .env for security!
#
# FOR LOCAL DEV: Use test key that works on localhost (always passes)
TURNSTILE_SECRET_KEY=1x0000000000000000000000000000000AA
# FOR PRODUCTION: Use your real key from Cloudflare Dashboard
# TURNSTILE_SECRET_KEY=0x4AAAAAACHmrfqdjuWH8nhgwEVTDHAqZTE

# Cron Job Secret (security token for cron endpoints)
# Generate with: openssl rand -hex 32
# CRITICAL: Change this in production!
CRON_SECRET=your-super-secret-cron-token-change-in-production-min-32-chars

# -------------------------------------------
# ===========================================
# RPC CONFIGURATION (OPTIONAL)
# ===========================================
# Crawler can optionally connect to your local blockchain node's RPC for additional peer discovery.
# This is NOT required - crawler works fine with just DNS seeds.
#
# UNCOMMENT these lines if you have a local node running:
# RPC_HOST=localhost  # Change to your node's IP/hostname if needed
# RPC_PORT=8332
# RPC_USER=rpcuser
# RPC_PASS=rpcpassword

# -------------------------------------------
# SETUP CHECKLIST
# -------------------------------------------
# Before running make cloud-dev:
#
# □ Created Supabase project
# □ Updated NEXT_PUBLIC_SUPABASE_URL above
# □ Updated NEXT_PUBLIC_SUPABASE_ANON_KEY above
# □ Updated SUPABASE_SERVICE_ROLE_KEY above
# □ Ran migrations: supabase link && supabase db push
# □ Created storage bucket: run setup-supabase-storage.sql
# □ (Optional) Added MaxMind credentials
#
# Then run: make cloud-dev

# ===========================================
# PRODUCTION DEPLOYMENT (REQUIRED FOR PROD)
# ===========================================
# These are ONLY needed when deploying to production with Caddy SSL
# Not needed for local development (make cloud-dev)
#
# Usage:
#   make prod-cloud    # Production with Caddy SSL
#
# For CI/CD deployment, add these as GitHub Secrets or AWS Parameter Store
# See docs/CICD.md for complete deployment guide
# ===========================================

# Your production domain (e.g., nodes.yourcoin.org)
# DOMAIN=nodes.example.com

# Email for Let's Encrypt SSL certificate notifications
# ACME_EMAIL=admin@example.com

# ===========================================
# DOCKER REGISTRY CONFIGURATION (CI/CD)
# ===========================================
# These variables are automatically injected by the CI/CD workflow
# You DON'T need to set these manually - they're shown here for reference
#
# The workflow reads registry config from config/project.config.yaml
# and injects these vars before deployment
#
# For GHCR (GitHub Container Registry):
#   REGISTRY_TYPE=ghcr
#   REGISTRY_PUBLIC=true
#   REGISTRY=ghcr.io/your-org
#   IMAGE_PREFIX=atlasp2p-
#   IMAGE_TAG=latest
#
# For ECR (AWS Elastic Container Registry):
#   REGISTRY_TYPE=ecr
#   REGISTRY_PUBLIC=false
#   REGISTRY_REGION=us-east-1
#   REGISTRY=123456789.dkr.ecr.us-east-1.amazonaws.com
#   IMAGE_PREFIX=atlasp2p/
#   IMAGE_TAG=latest
#
# See docs/CICD.md for complete registry configuration guide
