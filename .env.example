# ===========================================
# ATLASP2P - ENVIRONMENT CONFIGURATION
# ===========================================
# Copy this file to .env and fill in your values
# This is the template for local Docker development

# Docker Compose Project Name
# Controls container and image naming (e.g., atlasp2p-web, atlasp2p-db)
COMPOSE_PROJECT_NAME=atlasp2p

# PostgreSQL Database
POSTGRES_PASSWORD=postgres
POSTGRES_DB=postgres

# JWT Secret (generate with: openssl rand -hex 32)
# IMPORTANT: Change this in production!
JWT_SECRET=your-super-secret-jwt-token-with-at-least-32-characters-long

# Cron Job Secret (security token for cron endpoints)
# Generate with: openssl rand -hex 32
CRON_SECRET=your-super-secret-cron-token-change-in-production-min-32-chars

# Supabase API Keys
# For local dev, these match the JWT_SECRET above
# For production, generate new keys: https://supabase.com/docs/guides/auth/server-side/creating-a-client
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlzcyI6InN1cGFiYXNlIiwiaWF0IjoxNzY2MDI3MTQ0LCJleHAiOjIwODEzODcxNDR9.IMkrznYYwVAvdpa8D2fH9sgpNaludfgwNZ12HlwlRfg
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoic2VydmljZV9yb2xlIiwiaXNzIjoic3VwYWJhc2UiLCJpYXQiOjE3NjYwMjcxNDQsImV4cCI6MjA4MTM4NzE0NH0.lB1tLpSreJ7M98IZqjgXpC_TpOrrEivlZbiVAlWHlDU

# Application URLs (for local Docker development)
NEXT_PUBLIC_SUPABASE_URL=http://localhost:4020
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlzcyI6InN1cGFiYXNlIiwiaWF0IjoxNzY2MDI3MTQ0LCJleHAiOjIwODEzODcxNDR9.IMkrznYYwVAvdpa8D2fH9sgpNaludfgwNZ12HlwlRfg

# Supabase Internal URLs (Docker networking)
SUPABASE_URL=http://kong:8000
SUPABASE_INTERNAL_URL=http://kong:8000

# ===========================================
# PORT CONFIGURATION
# ===========================================
# All exposed ports - single source of truth
# Change these to run multiple instances or avoid conflicts
PORT=4000                      # Web app (Next.js)
WEB_PORT=4000                  # Web app external (same as PORT)
DB_PORT=4021                   # PostgreSQL direct access
KONG_PORT=4020                 # Supabase API Gateway
STUDIO_PORT=4022               # Supabase Studio UI
INBUCKET_WEB_PORT=4023         # Email testing UI
INBUCKET_SMTP_PORT=4024        # Email testing SMTP

# Site URLs (must match ports above)
# NOTE: Update these if you change WEB_PORT or KONG_PORT
SITE_URL=http://localhost:4000
API_EXTERNAL_URL=http://localhost:4020

# GeoIP (MaxMind)
# Get your account at: https://www.maxmind.com/en/geolite2/signup
MAXMIND_ACCOUNT_ID=your_maxmind_account_id
MAXMIND_LICENSE_KEY=your_maxmind_license_key

# ===========================================
# SMTP CONFIGURATION
# ===========================================
# Choose ONE option below:

# OPTION 1: RESEND SMTP (Production - Real Emails)
# Get API key at: https://resend.com/api-keys
# Make sure to verify your FROM email domain in Resend dashboard
SMTP_HOST=smtp.resend.com
SMTP_PORT=587
SMTP_USER=resend
SMTP_PASS=your_resend_api_key_here
SMTP_ADMIN_EMAIL=noreply@yourdomain.com
SMTP_SENDER_NAME=YourProjectName

# OPTION 2: INBUCKET (Local Development - View emails at http://localhost:4023)
# Uncomment these lines and comment out Resend config above
# SMTP_HOST=inbucket
# SMTP_PORT=2500
# SMTP_USER=
# SMTP_PASS=
# SMTP_ADMIN_EMAIL=admin@localhost
# SMTP_SENDER_NAME=YourProjectName

# Email Verification
GOTRUE_MAILER_AUTOCONFIRM=false

# RPC Configuration (connects to your blockchain node)
# For Docker: use host.docker.internal
# For production: use actual node IP/hostname
RPC_HOST=host.docker.internal
RPC_PORT=34645
RPC_USER=your_rpc_user
RPC_PASS=your_rpc_password

# -------------------------------------------
# EMAIL SERVICE SECRETS (PRODUCTION)
# -------------------------------------------
# Choose ONE provider (configured in project.config.yaml)
# All are optional for local development (uses Inbucket)

# Resend (recommended - https://resend.com)
RESEND_API_KEY=

# SendGrid (alternative - https://sendgrid.com)
SENDGRID_API_KEY=

# Custom SMTP (if using 'smtp' provider in config)
SMTP_USER=
SMTP_PASSWORD=
SMTP_TLS=true

# -------------------------------------------
# SECURITY - TURNSTILE (CLOUDFLARE)
# -------------------------------------------
# Cloudflare Turnstile for bot protection
# Get keys at: https://dash.cloudflare.com/turnstile
#
# NOTE: Turnstile config (enabled, siteKey, protectedActions) is in config/project.config.yaml
# ONLY the secret key goes in .env for security!
TURNSTILE_SECRET_KEY=

# ===========================================
# ADMIN CONFIGURATION
# ===========================================
# Super Admin Emails (comma-separated)
# These users have permanent admin access and cannot be removed via UI
# Example: ADMIN_EMAILS=admin@example.com,superadmin@example.com
ADMIN_EMAILS=your_admin_email@example.com

# ===========================================
# PRODUCTION DEPLOYMENT (REQUIRED FOR PROD)
# ===========================================
# These are ONLY needed when deploying to production with Caddy SSL
# Not needed for local development
#
# Usage:
#   make prod-docker   # Production self-hosted
#   make prod-cloud    # Production with cloud database
#
# For CI/CD deployment, add these as GitHub Secrets or AWS Parameter Store
# See docs/CICD.md for complete deployment guide
# ===========================================

# Your production domain (e.g., nodes.yourcoin.org)
# DOMAIN=nodes.example.com

# Email for Let's Encrypt SSL certificate notifications
# ACME_EMAIL=admin@example.com

# ===========================================
# DOCKER REGISTRY CONFIGURATION (CI/CD)
# ===========================================
# These variables are automatically injected by the CI/CD workflow
# You DON'T need to set these manually - they're shown here for reference
#
# The workflow reads registry config from config/project.config.yaml
# and injects these vars before deployment
#
# For GHCR (GitHub Container Registry):
#   REGISTRY_TYPE=ghcr
#   REGISTRY_PUBLIC=true
#   REGISTRY=ghcr.io/your-org
#   IMAGE_PREFIX=atlasp2p-
#   IMAGE_TAG=latest
#
# For ECR (AWS Elastic Container Registry):
#   REGISTRY_TYPE=ecr
#   REGISTRY_PUBLIC=false
#   REGISTRY_REGION=us-east-1
#   REGISTRY=123456789.dkr.ecr.us-east-1.amazonaws.com
#   IMAGE_PREFIX=atlasp2p/
#   IMAGE_TAG=latest
#
# See docs/CICD.md for complete registry configuration guide
